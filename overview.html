<!--Twinpeak-->
<!--Created By Tenor-Z-->
<!--overview.html -- main management system page-->
<!--Improvised on 2023/08/23-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>                       <!--tailwind looks so much damn better-->
    <title>TwinPeak Employee Management System</title>                                  <!--Once we redirect from the login page, set up this page-->
    <body background="interface.jpg" text="#000000" link="#FF0000"></body>              <!--Set the backgrounds-->

    <!--Perhaps for the longest list of employees imaginable, the client must be able to clearly see the information and what goes where-->
    <!--This is accomplished by just forming thin white borders around each resource to create a table-like effect-->
    <style>                                                
        th, td {
            border: 1px solid #ffffff;
        }
        td{
            color: white;
        }

    </style>
</head>
<body>

    <!--We must now set up the main interface system that contains the main window, the boxes to enter information and the buttons to submit or delete information-->
    <div class="flex justify-center flex-col my-10">
        <div class="flex justify-center">                                       <!--Create our rounded orange window-->
            <div class="w-11/12 lg:w-1/2">
                <div class="bg-orange-800 text-white text-center p-4 rounded-t-lg">
                    <h1 class="text-3xl font-bold text-center my-4">TwinPeak</h1>
                    <center><img src="logo.png" alt="twinpeak" class="w-7 h-7" style="width:150px;height:150px;"></center>
                    <br>
                    <h1 class="text-3xl font-bold text-center my-4">Employee Management System</h1>
                    <div class="flex justify-center">
                        <div class="w-1/2">
                            
                                <!--Now we create the main input buttons. These should cover basic employee information, not including banking info and such-->

                                <div class="mb-4 text-left">
                                    <label class="block text-white text-sm font-bold mb-2" for="name">
                                        Full Name
                                    </label>
                                    <input class="bg-white appearance-none border-2 border-gray-200 w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-slate-700 focus:text-white focus:border-purple-500" id="name" type="text" placeholder="Enter the Full Name of the employee">
                                </div>
                                <div class="mb-4 text-left">
                                    <label class="block text-white text-sm font-bold mb-2" for="email">
                                        Email
                                    </label>
                                    <input class="bg-white appearance-none border-2 border-gray-200 w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-slate-700 focus:text-white focus:border-purple-500" id="email" type="email" placeholder="Enter the Email of the employee" name="email">
                                </div>
                                <div class="mb-4 text-left">
                                    <label class="block text-white text-sm font-bold mb-2" for="phone">
                                        Phone
                                    </label>
                                    <input class="bg-white appearance-none border-2 border-gray-200 w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-slate-700 focus:text-white focus:border-purple-500" id="phone" type="text" placeholder="Enter the Phone Number" name="phone">
                                </div>
                                <div class="mb-4 text-left">
                                    <label class="block text-white text-sm font-bold mb-2" for="job">
                                        Job
                                    </label>
                                    <input class="bg-white appearance-none border-2 border-gray-200 w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-slate-700 focus:text-white focus:border-purple-500" id="job" type="text" placeholder="Enter the Job Position" name="job">
                                </div>
                                <div class="mb-4 text-left">
                                    <label class="block text-white text-sm font-bold mb-2" for="address">
                                        Address
                                    </label>
                                    <input class="bg-white appearance-none border-2 border-gray-200 w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-slate-700 focus:text-white focus:border-purple-500" id="address" type="text" placeholder="Enter the Address of the employee" name="address">
                                </div>
                                <div class="mb-4 text-left">
                                    <label class="block text-white text-sm font-bold mb-2" for="city">
                                        City/Province
                                    </label>
                                    <input class="bg-white appearance-none border-2 border-gray-200 w-full py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-slate-700 focus:text-white focus:border-purple-500" id="city" type="text" placeholder="Enter the Province or City of the employee" name="city">
                                </div>

                                <!--All that is left is to create the add and update button, which do what they basically say.-->
                                <!--Upon a button being clicked on, it will jump to the corresponding Javascript function embedded in this very file-->

                                <div class="flex justify-between gap-2 xl:gap-0 md:gap-0">
                                    <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" onclick="addEmployee()" type="button">
                                        Add Employee
                                    </button>
                                    <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" onclick="updateEmployee()" type="button">
                                        Update Employee
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>

        <!--Now we move on to the table information listing the employees added into the system. Simply, we take-->
        <!--the info from the input buttons and add them as input for each table cell-->
        <div class="flex justify-center">
            <div class="w-40/40 lg:w-120/120 flex flex-col justify-center bg-slate-900 p-4 rounded-b-lg">  <!--The window is technically 40 by 120 but the height will change-->
                <div class="flex gap-2 justify-center items-center">                               <!--Depending on how much info is entered, hence the usage of flex col-->
                    <img src="user.png" alt="user" class="w-7 h-7">
                    <h1 class="text-2xl text-white font-semibold">Employees</h1>            <!--All information is stored in local storage and can either be deleted manually or through clearing the browser cache-->
                    <img src="user.png" alt="user" class="w-7 h-7">
                </div>

                <!--Now we can create our table that stores the employee information-->
                <div class="flex justify-center mt-4">
                    <table class="table-fixed">
                        <thead class="bg-gray-800 text-white">
                            <tr class="text-center">
                                <th class="px-2 py-2">Full Name</th>
                                <th class="px-2 py-2">Phone</th>
                                <th class="px-2 py-2">Job</th>
                                <th class="px-2 py-2">Email</th>
                                <th class="px-2 py-2">Address</th>
                                <th class="px-2 py-2">City/Province</th>
                                <th class="px-2 py-2">Action</th>
                            </tr>
                        </thead>
                        <tbody id="employees"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>

<!--Here ends the actual HTML stuff and begins the scripting for the website and adding information to the table-->

<script>
    //To display information in a consistent fashion, we can create a class that holds the necessary info for each employee inputed
    //We can also generate an ID for each employee to make deleting and editing their information ten times easier

    class Employee {
        constructor(name, email, phone, job, address) {
            this.name = name;
            this.email = email;
            this.phone = phone;
            this.job = job;
            this.address = address;
            this.city = city;
        }
    }

    // This function is responsible for consistently displaying the information of the table
    function showEmployees() {
        let employees = JSON.parse(localStorage.getItem('employees'));      //Get the total amount of employees
        let employeesTable = document.getElementById('employees');     //Get each entry in the table
        employeesTable.innerHTML = '';
        if (employees != null) {                                        //If the table is not empty, display the information in the correct order, as well as
            for (let i = 0; i < employees.length; i++) {                //The action buttons to edit or delete said info. We obviously do this by calling the proper index for what we need
                employeesTable.innerHTML += `
                    <tr>
                        <td class="px-4 py-2">${employees[i].name}</td>
                        <td class="px-4 py-2">${employees[i].phone}</td>
                        <td class="px-4 py-2">${employees[i].job}</td>
                        <td class="px-4 py-2">${employees[i].email}</td>
                        <td class="px-4 py-2">${employees[i].address}</td>
                        <td class="px-4 py-2">${employees[i].city}</td>
                        <td class="px-4 py-2  flex justify-center gap-2">
                            <img onclick="editEmployee(${employees[i].id})" src="edit.png" alt="edit" class="w-6 h-6 cursor-pointer">
                            <img onclick="deleteEmployee(${employees[i].id})" src="remove.png" alt="delete" class="w-6 h-6 cursor-pointer">
                        </td>
                    </tr>
                `;
            }
        }
    }

    //This function adds employees to the table.
    //If the information provided already exists and validates the phone number provided
    //Obviously it isn't perfect but it does leave room for a proper area code and number to be entered without
    //too much or too little characters added
    function addEmployee() {
        let name = document.getElementById('name').value;       //Grab each info from the input boxes on the page
        let email = document.getElementById('email').value;
        let phone = document.getElementById('phone').value;
        let job = document.getElementById('job').value;
        let address = document.getElementById('address').value;
        let city = document.getElementById('city').value;
        let employees = JSON.parse(localStorage.getItem('employees'));
        if (employees == null) {                                          //If the table does not exist, create it
            employees = [];
        }
        let employee = new Employee(name, email, phone, job, address, city);  //The new employee added will consist of the information we gathered above
        let flag = 0;                                                                               //For error handling
        for (let i = 0; i < employees.length; i++) {        //If the number provided is the same as one that exists in the table, stop and prompt the error
            if (employees[i].phone == employee.phone) {
                flag = 1;
                break;
            }
        }
        //If none of the input fields are empty and the phone number has been validated (no less than 10 chars and no more than 14)
        //Add the employee to the table and display it on screen 
        if (flag == 0 && name != '' && email != '' && address != '' && phone != '' && city != '' && job != '' && phone.length >= 10 && phone.length <= 14) {
            employees.push(employee);                           //Add it to the list
            localStorage.setItem('employees', JSON.stringify(employees));       //Set it to a string in our local storage
            emptyFields();                  //Empty the contents of the input boxes
            showEmployees();         //And display the changes
        } else if (flag == 1) {                 //If there was an error (if the entry already exists)
            alert('Employee already exists');
        } else {
            alert('Please fill all the fields');
        }
    }

    //When the button to Edit Employee data is selected, the website simply puts the info from the selected entry to the input boxes
    //This allows the user to easily change the information without having to do any extra labor to get what they want to edit
    function editEmployee(id) {
        let employees = JSON.parse(localStorage.getItem('employees'));          //Get the selected entry from the employees table
        for (let i = 0; i < employees.length; i++) {
            if (employees[i].id == id) {
                document.getElementById('name').value = employees[i].name;          //Print the employee info to each input box above
                document.getElementById('email').value = employees[i].email;
                document.getElementById('phone').value = employees[i].phone;
                document.getElementById('job').value = employees[i].job;
                document.getElementById('address').value = employees[i].address;
                document.getElementById('city').value = employees[i].city;
                break;
            }
        }
    }

    //After an employee's info has been edited, it is best to click the 'Update Employee' button to write these
    //changes to the table. When the button is pressed, this function runs and takes the content edited in the input boxes
    //and applies it to the employee class that contains the original information
    function updateEmployee() {
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;  //Load each value with the original data to BE written
        let phone = document.getElementById('phone').value;
        let job = document.getElementById('job').value;
        let address = document.getElementById('address').value;
        let city = document.getElementById('city').value;
        let employees = JSON.parse(localStorage.getItem('employees'));      //Parse it to prepare for writing
        let id = 0;
        for (let i = 0; i < employees.length; i++) {
            if (employees[i].phone == phone || employees[i].email == email) {
                id = employees[i].id;
                break;
            }
        }
        
        //This ensures that the user knows what they are doing and wants to make these changes
        if (confirm('Are you sure you want to update this employee?')) {
            for (let i = 0; i < employees.length; i++) { //If answered Yes, make these changes to the employee table and display it
                if (employees[i].id == id) {                //If answered no, leave everything the way it is
                    employees[i].name = name;
                    employees[i].email = email;
                    employees[i].phone = phone;
                    employees[i].job = job;
                    employees[i].address = address;
                    employees[i].city = city;
                    break;
                }
            }
            localStorage.setItem('employees', JSON.stringify(employees));
            emptyFields();      //Clear the input boxes once more
            showEmployees();   //And display our results
        }
    }


    //If a user wishes to delete an employee, this function accomplishes just that.
    //Of course, this comes with a confirmation to ensure that nobody screws around (to some degree)
    function deleteEmployee(id) {
        let employees = JSON.parse(localStorage.getItem('employees'));   //Parse the information to be deleted
        if (confirm('Are you sure you want to delete this employee?')) {
            for (let i = 0; i < employees.length; i++) {        //If answered No, leave the information alone and exit
                if (employees[i].id == id) {                //If answered Yes, then remove all information about that employee and display the results
                    employees.splice(i, 1);
                    break;
                }
            }
            localStorage.setItem('employees', JSON.stringify(employees));
            showEmployees();
        }
    }

    //This is just a cleanup feature that clears the input boxes once they have served
    //their purposes
    function emptyFields() {
        document.getElementById('name').value = '';
        document.getElementById('email').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('job').value = '';
        document.getElementById('address').value = '';
        document.getElementById('city').value = '';
    }

    showEmployees();        //We must always show the changes being made, otherwise this would obviously cause inaccuracy to data

</script>

<footer class="bg-slate-100 text-black text-center p-4">
    <p>2023 Tenor-Z</p>
    <p class="text-sm">Visit <a href="https://github.com/tenor-z" target="_blank" class="text-blue-500">Tenor-Z's Github</a> for more projects</p>
</footer>
</html>